diff --git a/src/locale/ibm1047.h b/src/locale/ibm1047.h
new file mode 100644
index 0000000..99da271
--- /dev/null
+++ b/src/locale/ibm1047.h
@@ -0,0 +1,39 @@
+
+static const unsigned short ibm1047_to_uni[] = {
+0,1,2,3,156,9,134,127,151,141,142,11,12,13,14,15,
+16,17,18,19,157,133,8,135,24,25,146,143,28,29,30,31,
+128,129,130,131,132,10,23,27,136,137,138,139,140,5,6,7,
+144,145,22,147,148,149,150,4,152,153,154,155,20,21,158,26,
+32,160,226,228,224,225,227,229,231,241,162,46,60,40,43,124,
+38,233,234,235,232,237,238,239,236,223,33,36,42,41,59,94,
+45,47,194,196,192,193,195,197,199,209,166,44,37,95,62,63,
+248,201,202,203,200,205,206,207,204,96,58,35,64,39,61,34,
+216,97,98,99,100,101,102,103,104,105,171,187,240,253,254,177,
+176,106,107,108,109,110,111,112,113,114,170,186,230,184,198,164,
+181,126,115,116,117,118,119,120,121,122,161,191,208,91,222,174,
+172,163,165,183,169,167,182,188,189,190,221,168,175,93,180,215,
+123,65,66,67,68,69,70,71,72,73,173,244,246,242,243,245,
+125,74,75,76,77,78,79,80,81,82,185,251,252,249,250,255,
+92,247,83,84,85,86,87,88,89,90,178,212,214,210,211,213,
+48,49,50,51,52,53,54,55,56,57,179,219,220,217,218,159,
+};
+
+
+static const unsigned short uni_to_ibm1047[] = {
+0,0,0,0,55,45,46,47,22,5,37,0,0,0,0,0,
+0,0,0,0,60,61,50,38,0,0,63,39,0,0,0,0,
+64,90,127,123,91,108,80,125,77,93,92,78,107,96,75,97,
+240,241,242,243,244,245,246,247,248,249,122,94,76,126,110,111,
+124,193,194,195,196,197,198,199,200,201,209,210,211,212,213,214,
+215,216,217,226,227,228,229,230,231,232,233,173,224,189,95,109,
+121,129,130,131,132,133,134,135,136,137,145,146,147,148,149,150,
+151,152,153,162,163,164,165,166,167,168,169,192,79,208,161,7,
+32,33,34,35,36,21,6,23,40,41,42,43,44,9,10,27,
+48,49,26,51,52,53,54,8,56,57,58,59,4,20,62,255,
+65,170,74,177,159,178,106,181,187,180,154,138,176,202,175,188,
+144,143,234,250,190,160,0,179,157,218,155,139,183,184,185,171,
+100,101,98,102,99,103,158,104,116,113,114,115,120,117,118,119,
+172,105,237,238,235,239,236,191,128,253,254,251,252,186,174,89,
+68,69,66,70,67,71,156,72,84,81,82,83,88,85,86,87,
+140,73,205,206,203,207,204,225,112,221,222,219,220,141,142,223,
+};
diff --git a/src/locale/iconv.c b/src/locale/iconv.c
index fd2f2e0..69ec289 100644
--- a/src/locale/iconv.c
+++ b/src/locale/iconv.c
@@ -23,6 +23,7 @@
 #define GB2312      0332
 #define BIG5        0340
 #define EUC_KR      0350
+#define IBM1047     0360
 
 /* Definitions of charmaps. Each charmap consists of:
  * 1. Empty-string-terminated list of null-terminated aliases.
@@ -46,9 +47,12 @@ static const unsigned char charmaps[] =
 "gb2312\0\0\332"
 "big5\0bigfive\0cp950\0big5hkscs\0\0\340"
 "euckr\0ksc5601\0ksx1001\0cp949\0\0\350"
+"ibm1047\0cp1047\0\0\360"
 #include "codepages.h"
 ;
 
+#include "ibm1047.h"
+
 static const unsigned short legacy_chars[] = {
 #include "legacychars.h"
 };
@@ -106,7 +110,7 @@ iconv_t iconv_open(const char *to, const char *from)
 
 	if ((t = find_charmap(to))==-1
 	 || (f = find_charmap(from))==-1
-	 || (charmaps[t] >= 0320)) {
+	 || (charmaps[t] >= 0320 && charmaps[t] != 0360)) {
 		errno = EINVAL;
 		return (iconv_t)-1;
 	}
@@ -184,7 +188,10 @@ size_t iconv(iconv_t cd0, char **restrict in, size_t *restrict inb, char **restr
 		c = *(unsigned char *)*in;
 		l = 1;
 
-		if (c >= 128 || type-UTF_32BE < 7U) switch (type) {
+		if (type == IBM1047){
+			c = ibm1047_to_uni[c];
+		}else{
+			if (c >= 128 || type-UTF_32BE < 7U) switch (type) {
 		case UTF_8:
 			l = mbrtowc_utf8(&wc, *in, *inb, &st);
 			if (!l) l++;
@@ -375,8 +382,14 @@ size_t iconv(iconv_t cd0, char **restrict in, size_t *restrict inb, char **restr
 			c = legacy_map(map, c);
 			if (c==1) goto ilseq;
 		}
+	}
 
 		switch (totype) {
+		case IBM1047:
+			c = uni_to_ibm1047[c];
+			*(*out)++ = c;
+			*outb -= 1;
+			break;
 		case WCHAR_T:
 			if (*outb < sizeof(wchar_t)) goto toobig;
 			*(wchar_t *)*out = c;
